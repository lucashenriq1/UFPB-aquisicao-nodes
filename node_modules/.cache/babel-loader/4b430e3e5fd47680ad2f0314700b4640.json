{"ast":null,"code":"'use strict';\n\nvar Readable = require('readable-stream').Readable,\n  streamsOpts = {\n    objectMode: true\n  };\n\n/**\n * In-memory implementation of the message store\n * This can actually be saved into files.\n *\n */\nfunction Store() {\n  if (!(this instanceof Store)) {\n    return new Store();\n  }\n  this._inflights = {};\n}\n\n/**\n * Adds a packet to the store, a packet is\n * anything that has a messageId property.\n *\n */\nStore.prototype.put = function (packet, cb) {\n  this._inflights[packet.messageId] = packet;\n  if (cb) {\n    cb();\n  }\n  return this;\n};\n\n/**\n * Creates a stream with all the packets in the store\n *\n */\nStore.prototype.createStream = function () {\n  var stream = new Readable(streamsOpts),\n    inflights = this._inflights,\n    ids = Object.keys(this._inflights),\n    destroyed = false,\n    i = 0;\n  stream._read = function () {\n    if (!destroyed && i < ids.length) {\n      this.push(inflights[ids[i++]]);\n    } else {\n      this.push(null);\n    }\n  };\n  stream.destroy = function () {\n    if (destroyed) {\n      return;\n    }\n    var self = this;\n    destroyed = true;\n    process.nextTick(function () {\n      self.emit('close');\n    });\n  };\n  return stream;\n};\n\n/**\n * deletes a packet from the store.\n */\nStore.prototype.del = function (packet, cb) {\n  packet = this._inflights[packet.messageId];\n  if (packet) {\n    delete this._inflights[packet.messageId];\n    cb(null, packet);\n  } else if (cb) {\n    cb(new Error('missing packet'));\n  }\n  return this;\n};\n\n/**\n * get a packet from the store.\n */\nStore.prototype.get = function (packet, cb) {\n  packet = this._inflights[packet.messageId];\n  if (packet) {\n    cb(null, packet);\n  } else if (cb) {\n    cb(new Error('missing packet'));\n  }\n  return this;\n};\n\n/**\n * Close the store\n */\nStore.prototype.close = function (cb) {\n  this._inflights = null;\n  if (cb) {\n    cb();\n  }\n};\nmodule.exports = Store;","map":{"version":3,"names":["Readable","require","streamsOpts","objectMode","Store","_inflights","prototype","put","packet","cb","messageId","createStream","stream","inflights","ids","Object","keys","destroyed","i","_read","length","push","destroy","self","process","nextTick","emit","del","Error","get","close","module","exports"],"sources":["D:/UFPB/aquisição/hb/aquisicao/node_modules/mqtt-client/lib/store.js"],"sourcesContent":["'use strict';\nvar Readable = require('readable-stream').Readable,\n  streamsOpts = { objectMode: true };\n\n/**\n * In-memory implementation of the message store\n * This can actually be saved into files.\n *\n */\nfunction Store () {\n  if (!(this instanceof Store)) {\n    return new Store();\n  }\n\n  this._inflights = {};\n}\n\n/**\n * Adds a packet to the store, a packet is\n * anything that has a messageId property.\n *\n */\nStore.prototype.put = function (packet, cb) {\n  this._inflights[packet.messageId] = packet;\n\n  if (cb) {\n    cb();\n  }\n\n  return this;\n};\n\n/**\n * Creates a stream with all the packets in the store\n *\n */\nStore.prototype.createStream = function () {\n  var stream = new Readable(streamsOpts),\n    inflights = this._inflights,\n    ids = Object.keys(this._inflights),\n    destroyed = false,\n    i = 0;\n\n  stream._read = function () {\n    if (!destroyed && i < ids.length) {\n      this.push(inflights[ids[i++]]);\n    } else {\n      this.push(null);\n    }\n  };\n\n  stream.destroy = function () {\n    if (destroyed) {\n      return;\n    }\n\n    var self = this;\n\n    destroyed = true;\n\n    process.nextTick(function () {\n      self.emit('close');\n    });\n  };\n\n  return stream;\n};\n\n/**\n * deletes a packet from the store.\n */\nStore.prototype.del = function (packet, cb) {\n  packet = this._inflights[packet.messageId];\n  if (packet) {\n    delete this._inflights[packet.messageId];\n    cb(null, packet);\n  } else if (cb) {\n    cb(new Error('missing packet'));\n  }\n\n  return this;\n};\n\n/**\n * get a packet from the store.\n */\nStore.prototype.get = function (packet, cb) {\n  packet = this._inflights[packet.messageId];\n  if (packet) {\n    cb(null, packet);\n  } else if (cb) {\n    cb(new Error('missing packet'));\n  }\n\n  return this;\n};\n\n/**\n * Close the store\n */\nStore.prototype.close = function (cb) {\n  this._inflights = null;\n  if (cb) {\n    cb();\n  }\n};\n\nmodule.exports = Store;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}